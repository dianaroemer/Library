{"ast":null,"code":"import _regeneratorRuntime from\"/home/d/dev/projects/Library/library-react/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/home/d/dev/projects/Library/library-react/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/d/dev/projects/Library/library-react/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from'react';import uniqid from'uniqid';import'./App.css';import NavBar from'./Components/NavBar';import GameTile from'./Components/GameTile';import QueryMenu from'./Components/QueryMenu';// import {getFirestore, collection, getDocs, addDoc, serverTimestamp, query } from 'firebase/firestore/lite'\nimport{onSnapshot,getFirestore,addDoc,query,collection,setDoc,deleteDoc}from\"firebase/firestore\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function App(props){var db=getFirestore(props.firebaseapp);// async function handleTestButtonClick(e){\n//   e.preventDefault();\n//   console.log(`you clicked the test button`);\n//   try{\n//     const docRef = await addDoc(collection(db, \"testCollection\"), {\n//       firstName: \"bugger\",\n//       lastName: \"everything\",\n//       year: 2022,\n//       timeStamp: serverTimestamp()\n//     });\n//     console.log('Document written with id: ', docRef.id);\n//   } catch (e) {\n//     console.log(\"Error adding document: \", e);\n//   }\n// }\n// const [querySnapshot, setQuerySnapshot] = useState(\n//   async () => {await getDocs(collection(db, \"testCollection\"))}\n// );\n// function handleTestButtonClick1(e){\n//   e.preventDefault();\n//   getTestCollection(db);\n// }\n// async function getTestCollection(db){\n//   const testCol = collection(db, 'testCollection');\n//   const testSnapshot = await getDocs(testCol);\n//   const contentList = testSnapshot.docs.map(doc => doc.data());\n//   console.log(contentList);\n//   contentList.forEach( (doc) => {\n//     console.log(doc.timeStamp);\n//   })\n//   return contentList;\n// }\n// Init the shelf that stores game objects and data\nvar _useState=useState([]),_useState2=_slicedToArray(_useState,2),shelfData=_useState2[0],setShelfData=_useState2[1];// Init the snapshot keeping the front-end up to date with the server's databse\nuseEffect(function(){var q=query(collection(db,'shelf'));var unsubscribe=onSnapshot(q,function(qSnapshot){var datums=[];qSnapshot.forEach(function(doc){// console.log(doc)\ndatums.push({data:doc.data(),key:uniqid(),docRef:doc.ref});// docRef: doc(db, 'shelf', doc.id)});\nsetShelfData(datums);});// console.log(`Current Shelf Data: `, datums);\n});return function(){return unsubscribe();};},[db]);var myLibrary=[];shelfData.forEach(function(element){var tile=/*#__PURE__*/_jsx(GameTile,{gameData:element.data,docRef:element.docRef,handleClickModify:handleClickModify},element.key);myLibrary.push(tile);});// ------------------ queryMenu toggles and functionality ------------------\nvar _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),menuOpen=_useState4[0],toggleMenuOpen=_useState4[1];function handleToggleMenu(){// console.log(`You're trying to toggle queryMenu!`);\nif(!menuOpen){// console.log(`queryMenu is currently not open, Opening a new queryMenu...`);\n// DO THE THING TO OPEN THE MENU, something something show menuOpen\ntoggleMenuOpen(true);}else{// console.log(`queryMenu is already open! Closing queryMenu...`)\ntoggleMenuOpen(false);}}function handleClickMenuOpen(e){e.preventDefault();// console.log(`You clicked a button to open queryMenu. Checking queryMenu's state...`)\nif(!menuOpen){// console.log(`queryMenu is currently closed! Opening queryMenu`);\nhandleQueryMenuGameUpdate(null,null);handleToggleMenu();}else{// console.log(`queryMenu is already open! I can do nothing until the currently existing queryMenu has been closed!`);\n}}function handleClickModify(e,gameData,docRef){e.preventDefault();// console.log(`You are opening the queryMenu on an existing GameTile!`);\nif(!menuOpen){// console.log(`Its data is: `, gameData, docRef);\n// console.log(`queryMenu is currently closed! Opening queryMenu`);\nhandleQueryMenuGameUpdate(gameData,docRef);handleToggleMenu();}else{// console.log(`queryMenu is already open! I can do nothing until the currently existing queryMenu has been closed!`);\n}}function addNewDoc(_x,_x2){return _addNewDoc.apply(this,arguments);}function _addNewDoc(){_addNewDoc=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(e,queryMenuData){var docRef;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();// console.log(\"You're trying to add a new doc. Its data is: \", queryMenuData);\n// console.log('Trying to write new data to collection...');\n_context.next=3;return addDoc(collection(db,\"shelf\"),queryMenuData);case 3:docRef=_context.sent;console.log('Document written with ID: ',docRef.id);case 5:case\"end\":return _context.stop();}}},_callee);}));return _addNewDoc.apply(this,arguments);}var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),queryMenuGameData=_useState6[0],setQueryMenuGameData=_useState6[1];var _useState7=useState(null),_useState8=_slicedToArray(_useState7,2),queryMenuGameRef=_useState8[0],setQueryMenuGameRef=_useState8[1];// When this function is called with null in gameData and docRef, the queryMenu opens in its default state, whereas when this function is passed gameData and a gameRef from a Modify onClick, it updates queryMenu to use the new values of the targeted click\nfunction handleQueryMenuGameUpdate(gameData,docRef){gameData?setQueryMenuGameData(gameData):setQueryMenuGameData(null);docRef?setQueryMenuGameRef(docRef):setQueryMenuGameRef(null);}function deleteGameTile(_x3,_x4,_x5){return _deleteGameTile.apply(this,arguments);}function _deleteGameTile(){_deleteGameTile=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(e,gameData,gameRef){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:e.preventDefault();// console.log(`Do the thing to delete this GameTile`);\n// console.log(`The current data trying to be deleted is: `, gameData, gameRef);\n_context2.next=3;return deleteDoc(gameRef);case 3:case\"end\":return _context2.stop();}}},_callee2);}));return _deleteGameTile.apply(this,arguments);}function updateGameTile(_x6,_x7,_x8){return _updateGameTile.apply(this,arguments);}function _updateGameTile(){_updateGameTile=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(e,gameData,gameRef){return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:e.preventDefault();// console.log(`Do the thing to update the existing game within the firebase`)\n// console.log(`New data is: `, gameData, gameRef)\n_context3.next=3;return setDoc(gameRef,gameData,{merge:true});case 3:case\"end\":return _context3.stop();}}},_callee3);}));return _updateGameTile.apply(this,arguments);}return/*#__PURE__*/_jsxs(\"div\",{className:\"App\",children:[/*#__PURE__*/_jsx(NavBar,{}),/*#__PURE__*/_jsx(\"div\",{className:\"shelf\",children:myLibrary}),/*#__PURE__*/_jsx(\"button\",{className:\"addSlot\",onClick:function onClick(e){handleClickMenuOpen(e);},children:\" + \"}),menuOpen&&/*#__PURE__*/_jsx(QueryMenu,{handleToggleMenu:handleToggleMenu,addNewDoc:addNewDoc,queryMenuGameData:queryMenuGameData,queryMenuGameRef:queryMenuGameRef,deleteGameTile:deleteGameTile,updateGameTile:updateGameTile})]});}export default App;","map":{"version":3,"names":["React","useEffect","useState","uniqid","NavBar","GameTile","QueryMenu","onSnapshot","getFirestore","addDoc","query","collection","setDoc","deleteDoc","App","props","db","firebaseapp","shelfData","setShelfData","q","unsubscribe","qSnapshot","datums","forEach","doc","push","data","key","docRef","ref","myLibrary","element","tile","handleClickModify","menuOpen","toggleMenuOpen","handleToggleMenu","handleClickMenuOpen","e","preventDefault","handleQueryMenuGameUpdate","gameData","addNewDoc","queryMenuData","console","log","id","queryMenuGameData","setQueryMenuGameData","queryMenuGameRef","setQueryMenuGameRef","deleteGameTile","gameRef","updateGameTile","merge"],"sources":["/home/d/dev/projects/Library/library-react/src/App.js"],"sourcesContent":["import React, {useEffect, useState } from 'react';\nimport uniqid from 'uniqid';\nimport './App.css';\nimport NavBar from './Components/NavBar';\nimport GameTile from './Components/GameTile';\nimport QueryMenu from './Components/QueryMenu';\n\n// import {getFirestore, collection, getDocs, addDoc, serverTimestamp, query } from 'firebase/firestore/lite'\nimport {onSnapshot, getFirestore, addDoc, query, collection, setDoc, deleteDoc} from \"firebase/firestore\"\n\n\n\nfunction App(props) {\n\n  const db = getFirestore(props.firebaseapp);\n\n  // async function handleTestButtonClick(e){\n  //   e.preventDefault();\n  //   console.log(`you clicked the test button`);\n  //   try{\n  //     const docRef = await addDoc(collection(db, \"testCollection\"), {\n  //       firstName: \"bugger\",\n  //       lastName: \"everything\",\n  //       year: 2022,\n  //       timeStamp: serverTimestamp()\n  //     });\n  //     console.log('Document written with id: ', docRef.id);\n  //   } catch (e) {\n  //     console.log(\"Error adding document: \", e);\n  //   }\n  // }\n\n  // const [querySnapshot, setQuerySnapshot] = useState(\n  //   async () => {await getDocs(collection(db, \"testCollection\"))}\n  // );\n\n  // function handleTestButtonClick1(e){\n  //   e.preventDefault();\n  //   getTestCollection(db);\n  // }\n\n  // async function getTestCollection(db){\n  //   const testCol = collection(db, 'testCollection');\n  //   const testSnapshot = await getDocs(testCol);\n  //   const contentList = testSnapshot.docs.map(doc => doc.data());\n  //   console.log(contentList);\n  //   contentList.forEach( (doc) => {\n  //     console.log(doc.timeStamp);\n  //   })\n  //   return contentList;\n  // }\n\n\n  // Init the shelf that stores game objects and data\n  const [shelfData, setShelfData] = useState([]);\n  // Init the snapshot keeping the front-end up to date with the server's databse\n  useEffect(() => {\n    const q = query(collection(db, 'shelf'));\n    const unsubscribe = onSnapshot(q, (qSnapshot) => {\n      const datums = [];\n      qSnapshot.forEach( (doc) => {\n        // console.log(doc)\n        datums.push({\n          data: doc.data(),\n          key: uniqid(),\n          docRef: doc.ref})\n          // docRef: doc(db, 'shelf', doc.id)});\n        setShelfData(datums);\n      })\n      // console.log(`Current Shelf Data: `, datums);\n    })\n    return () => unsubscribe();\n  }, [db])\n\n\n\n  const myLibrary = [];\n  shelfData.forEach(element => {\n    const tile = <GameTile gameData={element.data} \n                    key={element.key}\n                    docRef={element.docRef}\n                    handleClickModify={handleClickModify}/>\n    myLibrary.push(tile)\n  })\n\n\n\n  // ------------------ queryMenu toggles and functionality ------------------\n\n  const [menuOpen, toggleMenuOpen] = useState(false);\n  function handleToggleMenu(){\n    // console.log(`You're trying to toggle queryMenu!`);\n    if(!menuOpen){\n      // console.log(`queryMenu is currently not open, Opening a new queryMenu...`);\n      // DO THE THING TO OPEN THE MENU, something something show menuOpen\n      toggleMenuOpen(true);\n    } else {\n      // console.log(`queryMenu is already open! Closing queryMenu...`)\n      toggleMenuOpen(false);\n    }\n  }\n\n  function handleClickMenuOpen(e){\n    e.preventDefault();\n    // console.log(`You clicked a button to open queryMenu. Checking queryMenu's state...`)\n    if(!menuOpen){\n      // console.log(`queryMenu is currently closed! Opening queryMenu`);\n      handleQueryMenuGameUpdate(null, null);\n      handleToggleMenu()\n    } else {\n      // console.log(`queryMenu is already open! I can do nothing until the currently existing queryMenu has been closed!`);\n    }\n  }\n\n  function handleClickModify(e, gameData, docRef){\n    e.preventDefault();\n    // console.log(`You are opening the queryMenu on an existing GameTile!`);\n    if(!menuOpen){\n      // console.log(`Its data is: `, gameData, docRef);\n      // console.log(`queryMenu is currently closed! Opening queryMenu`);\n      handleQueryMenuGameUpdate(gameData, docRef);\n      handleToggleMenu()\n    } else {\n      // console.log(`queryMenu is already open! I can do nothing until the currently existing queryMenu has been closed!`);\n    }\n  }\n\n  async function addNewDoc(e, queryMenuData) {\n    e.preventDefault();\n    // console.log(\"You're trying to add a new doc. Its data is: \", queryMenuData);\n    // console.log('Trying to write new data to collection...');\n    const docRef = await addDoc(collection(db, \"shelf\"), queryMenuData);\n    console.log('Document written with ID: ', docRef.id);\n\n  }\n\n\n\n  const [queryMenuGameData, setQueryMenuGameData] = useState(null);\n  const [queryMenuGameRef, setQueryMenuGameRef] = useState(null);\n  // When this function is called with null in gameData and docRef, the queryMenu opens in its default state, whereas when this function is passed gameData and a gameRef from a Modify onClick, it updates queryMenu to use the new values of the targeted click\n  function handleQueryMenuGameUpdate(gameData, docRef){\n    gameData ? setQueryMenuGameData(gameData) : setQueryMenuGameData(null);\n    docRef ? setQueryMenuGameRef(docRef) : setQueryMenuGameRef(null);\n  }\n\n  async function deleteGameTile(e, gameData, gameRef){\n    e.preventDefault();\n    // console.log(`Do the thing to delete this GameTile`);\n    // console.log(`The current data trying to be deleted is: `, gameData, gameRef);\n    await deleteDoc(gameRef);\n  }\n\n  async function updateGameTile(e, gameData, gameRef){\n    e.preventDefault();\n    // console.log(`Do the thing to update the existing game within the firebase`)\n    // console.log(`New data is: `, gameData, gameRef)\n    \n    \n    await setDoc(gameRef, gameData, {merge : true});\n  }\n  \n\n  return (\n    <div className=\"App\">\n      <NavBar/>\n\n      {/* This is the test button div, set to not display, but easily toggled visibility if I need to access these buttons */}\n      {/* <div className='devTestButtons' style={{display: 'none'}}>\n        Shiiiyeeet\n        <button onClick={(e) => {\n          handleTestButtonClick(e);\n        }}>test button</button>\n        <button onClick={(e) => {\n          handleTestButtonClick1(e);\n        }}>test button 1</button>\n        <button onClick={(e) => {\n        handleShelfData(e);\n      }}>log shelf data</button>\n      </div> */}\n\n\n      <div className='shelf'>\n        {myLibrary}\n      </div>\n\n\n      <button className='addSlot'\n        onClick={(e) => {\n          handleClickMenuOpen(e);\n        }}> + </button>\n\n\n      {menuOpen && <QueryMenu \n        handleToggleMenu={handleToggleMenu}\n        addNewDoc={addNewDoc}\n        queryMenuGameData={queryMenuGameData}\n        queryMenuGameRef={queryMenuGameRef}\n        deleteGameTile={deleteGameTile}\n        updateGameTile={updateGameTile}/>}\n\n\n      {/* <header className=\"App-header\">\n        <img src={logo} className=\"App-logo\" alt=\"logo\" />\n        <p>\n          Edit <code>src/App.js</code> and save to reload.\n        </p>\n        <a\n          className=\"App-link\"\n          href=\"https://reactjs.org\"\n          target=\"_blank\"\n          rel=\"noopener noreferrer\"\n        >\n          Learn React\n        </a>\n      </header> */}\n    </div>\n  );\n}\n\nexport default App;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}